#NoEnv
#Warn

SendMode, input
;~ SetCapsLockState, alwaysoff
SetNumLockState, alwayson
SetScrollLockState, AlwaysOff
SetTitleMatchMode, 1
CoordMode, Mouse, screen

EnvGet, pandora, Pandora
SetWorkingDir, %pandora%\ahk

#Include constants.ahk
#Include functions.ahk

global paths := new PathClass
global schedule := new ScheduleClass


if (debug!=0) {
	AsAdmin := 0
	change_env_mode("debug")
}

if (A_ComputerName="HEPHAESTUS") or schedule.check_working()
	change_env_mode("work")


get_screens_data(screens, debug)
paths.load()
;~ generateMenus()
HS := LoadHotstrings(paths["hotstring_ini"])
render_hotstrings(HS)

;~ Run watchdog.ahk

; load groups
for group, g_list in control_groups {
	for _, program in g_list {
		if InStr(program, "exe")
			GroupAdd, %group%, ahk_exe %program%
		else
			GroupAdd, %group%, %program%
	}
}

If AsAdmin and not A_IsAdmin
	Run, *RunAs autohotkey.exe "%A_ScriptFullPath%" /restart

#If (work_mode!=0)
	#Include vnc.ahk
