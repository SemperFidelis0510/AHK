;### Initialization
;~ #Requires AutoHotkey v2.0
#NoEnv
#Warn
#SingleInstance Force

#Include init.ahk
#Include chatgpt.ahk

;~ ### TODOs
;~ change paths to global variable in functions
;~ sort functions and utils


;### General
Insert::return
#Escape::close_win()


#Numpad7::   env_mode := "std"
#Numpad8::   env_mode := "work"
#Numpad9::   env_mode := "game"

#If (env_mode!="game")
	$XButton2::SearchWeb(,,1)
	#XButton2::SearchWeb(,,1,0)
	$XButton1::#^+s
	#XButton1::#+t
#If


;### Script Control
#Pause::Pause
+#Pause::ExitApp
#ScrollLock::Edit_SciTe(paths)
+#ScrollLock:: Reload_SciTE(paths)



;~ Scripts
#F1::
	tick := A_TickCount
	return
#F1 Up::
	tock := A_TickCount - tick
	if (tock>30)
		SearchWeb(, "google", 1)
	else
		listen(paths)

	return


; program browsers

#f:: browser(paths, "CabinetWClass", "folder") ; TODO: fix path. make path env_mode specific. go between tabs
#s:: browser(paths, "programming", "group") ; programming softwares
#m:: browser(paths, "OUTLOOK")  ; mail

#1:: browser(paths, "cmd", "window")
^#1:: Run % paths["cmd"]
#2:: browser(paths, "documents", "group")
#3:: browser(paths, "programming", "group") ; programming softwares
#4:: browser(paths, "communication", "group")

#y:: browser(paths, "youtube", "site") ; TODO: fix

;~ *CapsLock:: Run % paths["cmd"]
#`:: browser(paths, "chatgpt", "window",, 1)
#q:: browser(paths, "internet", "group") ; internet browsers
#a:: browser(paths, "WhatsApp", "winname",, 2)  ; communication programs ~ fix path

#NumLock:: browser(paths, "Calculator", "winname")


#If (env_mode="work")
	#w:: browser(paths, "vncviewer") ; vncviewer
	#e:: browser(paths, "ms-teams")
	#t:: browser(paths, "PDFXEdit", "tab") ; PDF browser
	#d:: browser(paths, "documents", "group")
	#n:: browser(paths, "ONENOTE",, 2) ; onenote
#If (env_mode!="work")
	#e:: browser(paths, "LyX", "tab") ; LyX browser
	#w:: browser(paths, "PDFXEdit", "tab") ; PDF browser
	#d:: browser(paths, "Discord") ; discord
#IF

; system settigns
	#If (env_mode!="game")
	#F2::  browser(paths, "ms-settings:apps-volume", "setting") ; sound settings
	#^F2:: browser(paths, "mmsys.cpl", "setting")
	;~ #F3::  browser(paths, "ms-settings:appsfeatures-app", "setting")
	#^F3:: browser(paths, "ms-settings:about", "setting")
	;~ #F4::  browser(paths, "ms-settings:display", "setting")
	;~ #F5::  browser(paths, "ms-settings:windowsupdate", "setting")
#If


; window shape and location
#Numpad1::   place_window(1) ; move to TV
#Numpad2::   place_window(2) ; move to Wacom
#Numpad3::   place_window(3) ; move to main screen
#Numpad5::   place_window("max")
#Numpad0::   place_window("unmax")
#NumpadSub:: place_window("min")
#NumpadAdd:: place_window("unmin")



; Media control
#Ins::      Spotify(paths, "run") ; ~ fix path
#WheelUp::  Volume_Up
#WheelDown::Volume_Down
#MButton::  Media_Play_Pause


; contextual
#IfWinActive ahk_exe ChatGPT.exe
Enter:: Send, +{Enter}
^Enter:: Send, {Enter}
^D::MClick(-987, 827)
#IfWinActive ahk_exe SciTE.exe
F1::Help_SciTE()
^R::reload
#IfWinActive ahk_exe PDFXEdit.exe
NumLock::
	WinActivate, ahk_exe winword.exe
	Sleep, 100
	Send, {F12}
F11::
	ControlSend,, ^{F11}, ahk_exe PDFXEdit.exe
	if (paths.computer[1]!="ZEUS2")
		ControlSend,, {z}, ahk_exe PDFXEdit.exe
	return
#If



#If (paths.computer[1] != "CHRONOS6")
AppsKey & Insert::    Media_Play_Pause
AppsKey & Delete::    Media_Stop
AppsKey & Home::      Media_Next
AppsKey & End::       Media_Prev
AppsKey & PgUp::      Volume_Up
AppsKey & PgDn::      Volume_Down
AppsKey & WheelUp::   Volume_Up
AppsKey & WheelDown:: Volume_Down
#IF

#IF (DetectLang()="HE")
~+::   SetCapsLockState, on
~+ UP::SetCapsLockState, AlwaysOff
#IF

#If debug
#1::  get_pressed_key()
^#1:: get_pressed_key(1)
#2::  get_activeWin_hwnd()
#3::  enum_screens()
#4::  get_mouse_pos()
#5::  name_computer()
#IF


;~ ideas and draft
;~ #IfWinActive ahk_exe WhatsApp.exe
;~ #`::send_love_emojis()

;~ >#End::     Spotify(paths, "like song")
;~ >#PgUp::    Spotify(paths, "save to playlist")
;~ >#PgDn::    Spotify(paths, "play playlist")

;~ #F2::RunScript("voiceControl")
;~ #F3::ChatGPT()


;~ UI
;~ XButton1::Browser_Back
;~ XButton2::Browser_Forward

;~ NumLock::rainmeter()

;~ $XButton1::voice_to_chatgpt()
;~ $XButton2::send, {Alt}{Shift}{b}

;~ WheelRight::+^Tab
;~ WheelLeft::^Tab


;~ #RButton UP::context_menu("show") ; TODO: fix
;~ XButton2::clip_to_mouse(paths)